import React, { useEffect, useState } from 'react';
import { useSelector } from 'react-redux';
import {
  Area, CartesianGrid, ComposedChart, Line, ResponsiveContainer, Tooltip, XAxis, YAxis,
} from 'recharts';
import Style from '../charts.module.css';

function ChartVulnerabilities() {
  const [data, setData] = useState([]);
  const dataSeverity = useSelector((state) => state.data.chartSeverity);

  useEffect(() => {
    const newData = Object.keys(dataSeverity)
      .map((element) => ({
        name: element,
        vulnerabilidades: dataSeverity[element],
      }));
    setData(newData);
  }, [dataSeverity]);

  return (
    <div className={Style.container}>
      <h1>Distribuição de vulnerabilidades não corrigidas por severidade</h1>
      {
        data && (
        <ResponsiveContainer width="100%" height="100%">
          <ComposedChart
            width={500}
            height={400}
            data={data}
            margin={{
              top: 10,
              right: 10,
              bottom: 10,
              left: 10,
            }}
          >
            <CartesianGrid />
            <XAxis dataKey="name" scale="auto" />
            <YAxis />
            <Tooltip />
            <Area type="natural" dataKey="vulnerabilidades" fill="#8884d8" stroke="white" />
            <Line type="natural" dataKey="vulnerabilidades" stroke="#ff4800" />
          </ComposedChart>
        </ResponsiveContainer>
        )
      }
    </div>
  );
}

export default ChartVulnerabilities;
