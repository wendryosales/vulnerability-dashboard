import { RECEIVE_HOSTS, REQUEST_HOSTS } from './actionsTypes';
import BASE_URL from './BASE_URL';

const requestHosts = () => ({ type: REQUEST_HOSTS });
const receiveHosts = (hosts) => ({
  type: RECEIVE_HOSTS,
  hosts,
});

/**
* Hosts API requests. you can sort the results. Default: random.
* @param {string} token
* @summary Send object with the data request to the redux state.
* @param {string} order options: 'hostname', 'ip_address', 'vuln_count,
*/
export default function fetchHosts(token, order) {
  const URL = `${BASE_URL}/api/assets/?ordering=${order}`;
  return async (dispatch) => {
    dispatch(requestHosts());
    const response = await fetch(URL, {
      method: 'get',
      headers: {
        Authorization: `Token ${token}`,
      },
    });
    const hosts = await response.json();
    return dispatch(receiveHosts(hosts));
  };
}
