import React from 'react';
import { RiFilterFill, RiFilterOffFill } from 'react-icons/ri';
import { useDispatch, useSelector } from 'react-redux';
import fetchHosts, { fetchHostsByVulnerabilities } from '../../../redux/actions/hosts';
import Style from '../Filter.module.css';

function FilterHosts() {
  const token = useSelector((state) => state.login.token);
  const dispatch = useDispatch();
  const vulnerabilities = useSelector((state) => state.vulnerabilities.data.results);

  const handleChange = ({ target }) => {
    dispatch(fetchHostsByVulnerabilities(token, target.value));
  };

  const handleClear = () => {
    dispatch(fetchHosts(token));
  };

  return (
    <div className={Style.container}>
      <div className={Style.clear}>
        <RiFilterFill />
        <label htmlFor="vulnerabilities">
          <select
            className="form-control"
            name="vulnerabilities"
            id="vulnerabilities"
            onChange={handleChange}
          >
            <option value="">Hosts que s√£o afetados por essa vulnerabilidade</option>
            {
              typeof vulnerabilities !== 'undefined' && vulnerabilities.map((element) => (
                <option key={element.id} value={element.id}>{element.title}</option>
              ))
            }
          </select>
        </label>
      </div>
      <div className={Style.clear}>
        <RiFilterOffFill />
        <button type="button" onClick={handleClear}>
          Limpar Filtros
        </button>
      </div>
    </div>
  );
}

export default FilterHosts;
