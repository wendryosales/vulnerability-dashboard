import PropTypes from 'prop-types';
import React from 'react';
import { AiFillCloseCircle } from 'react-icons/ai';
import { useDispatch, useSelector } from 'react-redux';
import { useParams } from 'react-router-dom/cjs/react-router-dom.min';
import changeStatus from '../../redux/actions/changeStatus';
import Style from './Modal.module.css';

function Modal({
  setConfirmChange, idVulnerability, previouStatus,
}) {
  const dispatch = useDispatch();
  const token = useSelector((state) => state.login.token);
  const { id } = useParams(); // id host
  const handleChange = () => {
    if (previouStatus === 1) { dispatch(changeStatus(token, idVulnerability, id, 0)); }
    if (previouStatus === 0) { dispatch(changeStatus(token, idVulnerability, id, 1)); }
    setConfirmChange(false);
  };

  return (
    <div className={Style.container}>
      <div className={Style.box}>
        <button type="button" onClick={() => setConfirmChange(false)} className={Style.close}>
          <AiFillCloseCircle />
        </button>
        <h1>Você realmente deseja realizar essa ação?</h1>
        <div className={Style.buttons}>
          <button type="button" onClick={handleChange} className={Style.yes}>SIM</button>
          <button type="button" onClick={() => setConfirmChange(false)} className={Style.no}>Não</button>
        </div>
      </div>
    </div>
  );
}

Modal.propTypes = {
  setConfirmChange: PropTypes.func.isRequired,
  idVulnerability: PropTypes.number.isRequired,
  previouStatus: PropTypes.number.isRequired,
};

export default Modal;
